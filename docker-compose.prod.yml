# Production configuration for Raspberry Pi 5
# Use this when deploying the pre-built Docker image to the Pi
# The app.py file is already baked into the image, no volume mounts needed

services:
  trix-hub:
    image: trix-hub:latest
    pull_policy: never  # Use locally loaded image, don't try to pull from Docker Hub
    container_name: trix-hub
    restart: unless-stopped

    # Environment variables
    environment:
      # trix-server connection (MatrixPortal M4)
      - TRIX_SERVER_URL=http://192.168.1.XX:80/bitmap

      # Display configuration
      - MATRIX_WIDTH=64
      - MATRIX_HEIGHT=32

      # Update interval (seconds)
      - UPDATE_INTERVAL=300

      # Timezone
      - TZ=America/New_York

    # Network mode (host network gives access to local network services)
    # 'host' mode required for accessing trix-server on local network via .local hostnames
    network_mode: host

    # Logging configuration
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

    # Resource limits (adjust based on Pi 5 capacity)
    deploy:
      resources:
        limits:
          cpus: '2.0'
          memory: 512M
        reservations:
          cpus: '0.5'
          memory: 128M
